<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.6.39">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Viktor Weißenborn">
<meta name="dcterms.date" content="2024-10-16">

<title>MAP4C: One chiral fingerprint to find them all (Orsi and Reymond 2024) – Lamalab Tool and Paper Notes</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
/* CSS for citations */
div.csl-bib-body { }
div.csl-entry {
  clear: both;
  margin-bottom: 0em;
}
.hanging-indent div.csl-entry {
  margin-left:2em;
  text-indent:-2em;
}
div.csl-left-margin {
  min-width:2em;
  float:left;
}
div.csl-right-inline {
  margin-left:2em;
  padding-left:1em;
}
div.csl-indent {
  margin-left: 2em;
}</style>


<script src="../site_libs/quarto-nav/quarto-nav.js"></script>
<script src="../site_libs/quarto-nav/headroom.min.js"></script>
<script src="../site_libs/clipboard/clipboard.min.js"></script>
<script src="../site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="../site_libs/quarto-search/fuse.min.js"></script>
<script src="../site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="../">
<link href="../papers/lwreg_2024.html" rel="next">
<link href="../papers/open-source-cheminformatics.html" rel="prev">
<script src="../site_libs/quarto-html/quarto.js"></script>
<script src="../site_libs/quarto-html/popper.min.js"></script>
<script src="../site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="../site_libs/quarto-html/anchor.min.js"></script>
<link href="../site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="../site_libs/quarto-html/quarto-syntax-highlighting-e26003cea8cd680ca0c55a263523d882.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="../site_libs/bootstrap/bootstrap.min.js"></script>
<link href="../site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="../site_libs/bootstrap/bootstrap-78faf54a06e50be45dc6d83ab59297a7.min.css" rel="stylesheet" append-hash="true" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "sidebar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "start",
  "type": "textbox",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN") {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body class="nav-sidebar floating">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
  <nav class="quarto-secondary-nav">
    <div class="container-fluid d-flex">
      <button type="button" class="quarto-btn-toggle btn" data-bs-toggle="collapse" role="button" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
        <i class="bi bi-layout-text-sidebar-reverse"></i>
      </button>
        <nav class="quarto-page-breadcrumbs" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../papers/llm4mat.html">Papers</a></li><li class="breadcrumb-item"><a href="../papers/universal_chiral_fp_2024.html"><span class="chapter-title">MAP4C: One chiral fingerprint to find them all <span class="citation" data-cites="orsi2024one">(</span></span></a><a href="#ref-orsi2024one" role="doc-biblioref">Orsi and Reymond 2024</a>)</li></ol></nav>
        <a class="flex-grow-1" role="navigation" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item" aria-controls="quarto-sidebar" aria-expanded="false" aria-label="Toggle sidebar navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">      
        </a>
      <button type="button" class="btn quarto-search-button" aria-label="Search" onclick="window.quartoOpenSearch();">
        <i class="bi bi-search"></i>
      </button>
    </div>
  </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <div class="pt-lg-2 mt-2 text-left sidebar-header">
    <div class="sidebar-title mb-0 py-0">
      <a href="../">Lamalab Tool and Paper Notes</a> 
    </div>
      </div>
        <div class="mt-2 flex-shrink-0 align-items-center">
        <div class="sidebar-search">
        <div id="quarto-search" class="" title="Search"></div>
        </div>
        </div>
    <div class="sidebar-menu-container"> 
    <ul class="list-unstyled mt-1">
        <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../index.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Tool and paper minutes</span></a>
  </div>
</li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true">
 <span class="menu-text">Tools</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-1" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-1" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tools/hydra.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Hydra</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tools/ip_rotator.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">IP Rotator</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tools/polars.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Polars</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tools/thunder_client.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Thunder Client</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tools/tmux.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">tmux</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tools/trimean.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Robust statistics and Trimean</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tools/pandarallel.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Easy fast <code>.apply</code> for pandas</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tools/bfg.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">BFG Repo-Cleaner</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../tools/showyourwork.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">showyourwork</span></a>
  </div>
</li>
      </ul>
  </li>
        <li class="sidebar-item sidebar-item-section">
      <div class="sidebar-item-container"> 
            <a class="sidebar-item-text sidebar-link text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true">
 <span class="menu-text">Papers</span></a>
          <a class="sidebar-item-toggle text-start" data-bs-toggle="collapse" data-bs-target="#quarto-sidebar-section-2" role="navigation" aria-expanded="true" aria-label="Toggle section">
            <i class="bi bi-chevron-right ms-2"></i>
          </a> 
      </div>
      <ul id="quarto-sidebar-section-2" class="collapse list-unstyled sidebar-section depth1 show">  
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/llm4mat.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Leveraging language representation for materials exploration and discovery</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/chem_yield_prediction_2024.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Uncertainty-Aware Yield Prediction with Multimodal Molecular Features</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/dagdelen_data_extraction.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Structured information extraction from scientific text with large language models</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/MolCLR_2024.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Molecular contrastive learning of representations (MolCLR) via graph neural networks</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/PaCh.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">PaCh (Packed Chemicals): Computationally Effective Binary Format for Chemical Structure Encoding</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/ms_prediction_graph_transformers/tandem_ms_prediction_graph_transformers.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Tandem mass spectrum prediction for small molecules using graph transformers</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/open-source-cheminformatics.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Open-Source Software Development in Cheminformatics: A Qualitative Analysis of Rationales</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/universal_chiral_fp_2024.html" class="sidebar-item-text sidebar-link active"><span class="chapter-title">MAP4C: One chiral fingerprint to find them all <span class="citation" data-cites="orsi2024one">(</span></span></a><a href="#ref-orsi2024one" role="doc-biblioref">Orsi and Reymond 2024</a>)
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/lwreg_2024.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">lwreg: A Lightweight System for Chemical Registration and Data Storage <span class="citation" data-cites="landrum_lwreg_2024">(</span></span></a><a href="#ref-landrum_lwreg_2024" role="doc-biblioref">Landrum et al. 2024</a>)
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/tango.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">It Takes Two to Tango: Directly Optimizing for Constrained Synthesizability in Generative Molecular Design <span class="citation" data-cites="https://doi.org/10.48550/arxiv.2410.11527">(</span></span></a><a href="#ref-https://doi.org/10.48550/arxiv.2410.11527" role="doc-biblioref">Guo and Schwaller 2024</a>)
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/core_bench.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">CORE-Bench: Fostering the Credibility of Published Research Through a Computational Reproducibility Agent Benchmark</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/bpm_L.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">A Bond-Based Machine Learning Model for Molecular Polarizabilities and A Priori Raman Spectra</span></a>
  </div>
</li>
          <li class="sidebar-item">
  <div class="sidebar-item-container"> 
  <a href="../papers/coconut.html" class="sidebar-item-text sidebar-link"><span class="chapter-title">Training Large Language Models to Reason in a Continuous Latent Space</span></a>
  </div>
</li>
      </ul>
  </li>
    </ul>
    </div>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Table of contents</h2>
   
  <ul>
  <li><a href="#why-did-i-choose-this-paper" id="toc-why-did-i-choose-this-paper" class="nav-link active" data-scroll-target="#why-did-i-choose-this-paper">Why did I choose this paper?</a></li>
  <li><a href="#general" id="toc-general" class="nav-link" data-scroll-target="#general">General</a></li>
  <li><a href="#prior-work" id="toc-prior-work" class="nav-link" data-scroll-target="#prior-work">Prior work</a>
  <ul class="collapse">
  <li><a href="#extended-connectivity-fingerprint-rogers2010extended" id="toc-extended-connectivity-fingerprint-rogers2010extended" class="nav-link" data-scroll-target="#extended-connectivity-fingerprint-rogers2010extended">Extended connectivity fingerprint <span class="citation" data-cites="rogers2010extended">(Rogers and Hahn 2010)</span></a></li>
  <li><a href="#atom-pair-fingerprint-carhart1985atom" id="toc-atom-pair-fingerprint-carhart1985atom" class="nav-link" data-scroll-target="#atom-pair-fingerprint-carhart1985atom">Atom-Pair fingerprint <span class="citation" data-cites="carhart1985atom">(Carhart, Smith, and Venkataraghavan 1985)</span></a></li>
  <li><a href="#ap-vs-ecfp" id="toc-ap-vs-ecfp" class="nav-link" data-scroll-target="#ap-vs-ecfp">AP vs ECFP</a></li>
  </ul></li>
  <li><a href="#abstract" id="toc-abstract" class="nav-link" data-scroll-target="#abstract">Abstract</a></li>
  <li><a href="#introduction" id="toc-introduction" class="nav-link" data-scroll-target="#introduction">Introduction</a></li>
  <li><a href="#methods" id="toc-methods" class="nav-link" data-scroll-target="#methods">Methods</a></li>
  <li><a href="#results" id="toc-results" class="nav-link" data-scroll-target="#results">Results</a></li>
  <li><a href="#conclusion" id="toc-conclusion" class="nav-link" data-scroll-target="#conclusion">Conclusion</a></li>
  <li><a href="#what-i-likeddidnt-like-about-the-paper" id="toc-what-i-likeddidnt-like-about-the-paper" class="nav-link" data-scroll-target="#what-i-likeddidnt-like-about-the-paper">What I liked/didn’t like about the paper</a></li>
  <li><a href="#references" id="toc-references" class="nav-link" data-scroll-target="#references">References</a></li>
  </ul>
</nav>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default"><nav class="quarto-page-breadcrumbs quarto-title-breadcrumbs d-none d-lg-block" aria-label="breadcrumb"><ol class="breadcrumb"><li class="breadcrumb-item"><a href="../papers/llm4mat.html">Papers</a></li><li class="breadcrumb-item"><a href="../papers/universal_chiral_fp_2024.html"><span class="chapter-title">MAP4C: One chiral fingerprint to find them all <span class="citation" data-cites="orsi2024one">(</span></span></a><a href="#ref-orsi2024one" role="doc-biblioref">Orsi and Reymond 2024</a>)</li></ol></nav>
<div class="quarto-title">
<h1 class="title"><span class="chapter-title">MAP4C: One chiral fingerprint to find them all <span class="citation" data-cites="orsi2024one">(<a href="#ref-orsi2024one" role="doc-biblioref">Orsi and Reymond 2024</a>)</span></span></h1>
</div>



<div class="quarto-title-meta">

    <div>
    <div class="quarto-title-meta-heading">Author</div>
    <div class="quarto-title-meta-contents">
             <p>Viktor Weißenborn </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Published</div>
    <div class="quarto-title-meta-contents">
      <p class="date">October 16, 2024</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<section id="why-did-i-choose-this-paper" class="level2">
<h2 class="anchored" data-anchor-id="why-did-i-choose-this-paper">Why did I choose this paper?</h2>
<ul>
<li>one of the latest papers for molecular fingerprints</li>
<li>combines two important FPs being ECFP and AP FPs</li>
<li>wanted to learn something about fingerprints, because of potential importance for future machine learning tasks</li>
</ul>
</section>
<section id="general" class="level2">
<h2 class="anchored" data-anchor-id="general">General</h2>
<ul>
<li><strong>Authors</strong>:
<ul>
<li>Markus Orsi → University of Bern, Biochemistry and Pharmacy</li>
<li>Jean-Louis Reymond → same as Orsi</li>
<li>both are Cheminformaticians (MAYGEN, Surge, etc)</li>
</ul></li>
<li><strong>Journal</strong>:
<ul>
<li>Journal of Cheminformatics, 2024</li>
</ul></li>
<li><strong>Notes</strong>:
<ul>
<li>MAP4C = Minhashed Atom-Pair Chiral Fingerprint with diameter 4</li>
<li>builds on top of previously published MAP4 <span class="citation" data-cites="capecchi2020one">(<a href="#ref-capecchi2020one" role="doc-biblioref">Capecchi, Probst, and Reymond 2020</a>)</span></li>
</ul></li>
</ul>
</section>
<section id="prior-work" class="level2">
<h2 class="anchored" data-anchor-id="prior-work">Prior work</h2>
<section id="extended-connectivity-fingerprint-rogers2010extended" class="level3">
<h3 class="anchored" data-anchor-id="extended-connectivity-fingerprint-rogers2010extended">Extended connectivity fingerprint <span class="citation" data-cites="rogers2010extended">(<a href="#ref-rogers2010extended" role="doc-biblioref">Rogers and Hahn 2010</a>)</span></h3>
<ul>
<li>digital representation of a molecule’s structure</li>
<li>conversion of molecule’s structural or chemical features into a binary or bit-string format</li>
<li>historically developed for substructure and similarity searching + structure-activity modeling</li>
<li>advantages: fast calculation and representation of infinite number of molecular features</li>
</ul>
<section id="workflow" class="level4">
<h4 class="anchored" data-anchor-id="workflow">Workflow</h4>
<p><br>
</p>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="universal_chiral_fp_2024_images/butyramide.png" class="img-fluid quarto-figure quarto-figure-center figure-img" width="300"></p>
</figure>
</div>
<p><br>
</p>
<ul>
<li><strong>Step 1: Assigning an integer identifier to each atom</strong>
<ul>
<li>random enumeration of atoms</li>
<li>for each atom the following properties are then quantified
<ul>
<li>Number of non-hydrogen immediate neighbors (3)</li>
<li>total bond order ignoring bonds to hydrogens (4 - 0)</li>
<li>Atomic number (6)</li>
<li>Atomic mass (12)</li>
<li>Atomic charge (0)</li>
<li>Number of attached hydrogens (0)</li>
<li>is atom part of ring? (0 –&gt; no)</li>
</ul></li>
<li>all features are then hashed into one integer</li>
</ul>
<div class="sourceCode" id="cb1"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb1-1"><a href="#cb1-1" aria-hidden="true" tabindex="-1"></a>identifier <span class="op">=</span> <span class="bu">hash</span>((<span class="dv">3</span>, <span class="dv">4</span>, <span class="dv">6</span>, <span class="dv">12</span>, <span class="dv">0</span>, <span class="dv">0</span>, <span class="dv">0</span>))</span>
<span id="cb1-2"><a href="#cb1-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(identifier)</span>
<span id="cb1-3"><a href="#cb1-3" aria-hidden="true" tabindex="-1"></a><span class="co"># -2155244659601281804</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>repeat this process for all non-hydrogen atoms</li>
</ul>
<div class="sourceCode" id="cb2"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb2-1"><a href="#cb2-1" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 0</span></span>
<span id="cb2-2"><a href="#cb2-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb2-3"><a href="#cb2-3" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>: <span class="op">-</span><span class="dv">4080868480043360372</span></span>
<span id="cb2-4"><a href="#cb2-4" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>:  <span class="dv">8311098529014133067</span></span>
<span id="cb2-5"><a href="#cb2-5" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>:  <span class="dv">8311098529014133067</span></span>
<span id="cb2-6"><a href="#cb2-6" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>: <span class="op">-</span><span class="dv">2155244659601281804</span></span>
<span id="cb2-7"><a href="#cb2-7" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>: <span class="op">-</span><span class="dv">3602994677767288312</span></span>
<span id="cb2-8"><a href="#cb2-8" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>:  <span class="dv">8573586092015465947</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div></li>
<li><strong>Step 2: Iteratively updating the atom identifiers</strong>
<ul>
<li>initialization of list of tuples with iteration number and identifier (Atom 4)</li>
</ul>
<div class="sourceCode" id="cb3"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb3-1"><a href="#cb3-1" aria-hidden="true" tabindex="-1"></a>[(<span class="dv">1</span>, <span class="op">-</span><span class="dv">2155244659601281804</span>)]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>addition of two more numbers for each non-hydrogen neighbor
<ul>
<li>first: bond order</li>
<li>second: neighbours identifier</li>
</ul></li>
<li>conversion to pure list</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb4-1"><a href="#cb4-1" aria-hidden="true" tabindex="-1"></a>[<span class="dv">1</span>, <span class="op">-</span><span class="dv">2155244659601281804</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">3602994677767288312</span>, <span class="dv">1</span>, <span class="dv">8311098529014133067</span>, <span class="dv">2</span>, <span class="dv">8573586092015465947</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>list is then hashed again
<ul>
<li>feature now includes information about direct neighbors</li>
</ul></li>
</ul>
<div class="sourceCode" id="cb5"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb5-1"><a href="#cb5-1" aria-hidden="true" tabindex="-1"></a>identifier_updated <span class="op">=</span> <span class="bu">hash</span>([<span class="dv">1</span>, <span class="op">-</span><span class="dv">2155244659601281804</span>, <span class="dv">1</span>, <span class="op">-</span><span class="dv">3602994677767288312</span>, <span class="dv">1</span>, <span class="dv">8311098529014133067</span>, <span class="dv">2</span>, <span class="dv">8573586092015465947</span>])</span>
<span id="cb5-2"><a href="#cb5-2" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(identifier_updated)</span>
<span id="cb5-3"><a href="#cb5-3" aria-hidden="true" tabindex="-1"></a><span class="co"># 3790237506519639747</span></span>
<span id="cb5-4"><a href="#cb5-4" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-5"><a href="#cb5-5" aria-hidden="true" tabindex="-1"></a>...</span>
<span id="cb5-6"><a href="#cb5-6" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-7"><a href="#cb5-7" aria-hidden="true" tabindex="-1"></a><span class="co"># Iteration 1</span></span>
<span id="cb5-8"><a href="#cb5-8" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb5-9"><a href="#cb5-9" aria-hidden="true" tabindex="-1"></a><span class="dv">1</span>: <span class="op">-</span><span class="dv">3879702859024654160</span></span>
<span id="cb5-10"><a href="#cb5-10" aria-hidden="true" tabindex="-1"></a><span class="dv">2</span>:  <span class="dv">2648074263463118673</span></span>
<span id="cb5-11"><a href="#cb5-11" aria-hidden="true" tabindex="-1"></a><span class="dv">3</span>:  <span class="dv">9209025387859845960</span></span>
<span id="cb5-12"><a href="#cb5-12" aria-hidden="true" tabindex="-1"></a><span class="dv">4</span>:  <span class="dv">3790237506519639747</span></span>
<span id="cb5-13"><a href="#cb5-13" aria-hidden="true" tabindex="-1"></a><span class="dv">5</span>: <span class="op">-</span><span class="dv">8399737669368778010</span></span>
<span id="cb5-14"><a href="#cb5-14" aria-hidden="true" tabindex="-1"></a><span class="dv">6</span>:  <span class="dv">3271801898087186516</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>repetition of the mentioned process but with neighbors of neighbors (Iteration 2)</li>
<li>after each iteration the identifiers are added to a feature list</li>
</ul>
<div class="sourceCode" id="cb6"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb6-1"><a href="#cb6-1" aria-hidden="true" tabindex="-1"></a><span class="co"># 18 items, 6 per iteration  (0, 1 and 2)</span></span>
<span id="cb6-2"><a href="#cb6-2" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-3"><a href="#cb6-3" aria-hidden="true" tabindex="-1"></a>[<span class="op">-</span><span class="dv">4080868480043360372</span>, <span class="dv">8311098529014133067</span>, <span class="dv">8311098529014133067</span>, <span class="op">-</span><span class="dv">2155244659601281804</span>, <span class="op">-</span><span class="dv">3602994677767288312</span>, <span class="dv">8573586092015465947</span>, <span class="op">-</span><span class="dv">3879702859024654160</span>, <span class="dv">2648074263463118673</span>, <span class="dv">9209025387859845960</span>, <span class="dv">3790237506519639747</span>, <span class="op">-</span><span class="dv">8399737669368778010</span>, <span class="dv">3271801898087186516</span>, <span class="dv">7820245418060671737</span>, <span class="op">-</span><span class="dv">8234949431280515543</span>, <span class="op">-</span><span class="dv">5902629546112570760</span>, <span class="op">-</span><span class="dv">3660103599533977242</span>, <span class="op">-</span><span class="dv">5964710996914813053</span>, <span class="dv">8916398073441202914</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="universal_chiral_fp_2024_images/ecfp_iterations.jpeg" class="img-fluid figure-img" width="600"></p>
<figcaption>Iterations shown with different example: benzoic acid amide</figcaption>
</figure>
</div></li>
</ul>
<p><br>
</p>
<ul>
<li><strong>Step 3: Deduplication</strong>
<ul>
<li>removing duplicates from feature list (4 removed, 14 left)</li>
</ul></li>
</ul>
<p><br>
</p>
<ul>
<li><strong>Step 4: Conversion of identifiers to bit array</strong>
<ul>
<li>initialize 1024 bit zero-array</li>
</ul>
<div class="sourceCode" id="cb7"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb7-1"><a href="#cb7-1" aria-hidden="true" tabindex="-1"></a><span class="im">import</span> numpy <span class="im">as</span> np</span>
<span id="cb7-2"><a href="#cb7-2" aria-hidden="true" tabindex="-1"></a>fp <span class="op">=</span> np.zeros(<span class="dv">1024</span>)     <span class="co"># traditionally a 1024 bit array is chosen</span></span>
<span id="cb7-3"><a href="#cb7-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fp)</span>
<span id="cb7-4"><a href="#cb7-4" aria-hidden="true" tabindex="-1"></a><span class="co"># array([0., 0., 0., ..., 0., 0., 0.])</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>division of each identifier by bit-array length (1024) and calculation of remainder
<ul>
<li>Example: <code>4080868480043360372 % 1024 = 908</code></li>
</ul></li>
</ul>
<div class="sourceCode" id="cb8"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb8-1"><a href="#cb8-1" aria-hidden="true" tabindex="-1"></a>remainders <span class="op">=</span> [<span class="dv">908</span>, <span class="dv">331</span>, <span class="dv">244</span>, <span class="dv">520</span>, <span class="dv">475</span>, <span class="dv">176</span>, <span class="dv">849</span>, <span class="dv">840</span>, <span class="dv">707</span>, <span class="dv">742</span>, <span class="dv">84</span>, <span class="dv">553</span>, <span class="dv">632</span>, <span class="dv">358</span>]</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>each remainder represents the position/index in the bit zero-array at which a zero is changed to a one</li>
</ul>
<div class="sourceCode" id="cb9"><pre class="sourceCode python code-with-copy"><code class="sourceCode python"><span id="cb9-1"><a href="#cb9-1" aria-hidden="true" tabindex="-1"></a><span class="cf">for</span> x <span class="kw">in</span> remainders:</span>
<span id="cb9-2"><a href="#cb9-2" aria-hidden="true" tabindex="-1"></a>fp[x] <span class="op">=</span> <span class="dv">1</span></span>
<span id="cb9-3"><a href="#cb9-3" aria-hidden="true" tabindex="-1"></a><span class="bu">print</span>(fp)</span>
<span id="cb9-4"><a href="#cb9-4" aria-hidden="true" tabindex="-1"></a><span class="co"># [0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 1, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0]</span></span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<ul>
<li>final bit array has been created = molecular fingerprint</li>
</ul></li>
</ul>
<p><br>
</p>
</section>
</section>
<section id="atom-pair-fingerprint-carhart1985atom" class="level3">
<h3 class="anchored" data-anchor-id="atom-pair-fingerprint-carhart1985atom">Atom-Pair fingerprint <span class="citation" data-cites="carhart1985atom">(<a href="#ref-carhart1985atom" role="doc-biblioref">Carhart, Smith, and Venkataraghavan 1985</a>)</span></h3>
<p><br>
</p>
<ul>
<li>similar to ECFP but for each atom all possible atom pairs including their distance are collected as features <img src="universal_chiral_fp_2024_images/atom_pairs.png" class="img-fluid quarto-figure quarto-figure-center" width="450" alt="a collection of example atom pairs which will be hashed later as features is shown in the following table"></li>
</ul>
</section>
<section id="ap-vs-ecfp" class="level3">
<h3 class="anchored" data-anchor-id="ap-vs-ecfp">AP vs ECFP</h3>
<ul>
<li>AP is suitable for large molecules but does not encode molecular structure in detail</li>
<li>ECFP is very detailed and suitable for small molecules but misses poor perception of global features</li>
</ul>
</section>
</section>
<section id="abstract" class="level2">
<h2 class="anchored" data-anchor-id="abstract">Abstract</h2>
<ul>
<li><p>chirality often not considered in fingerprints</p></li>
<li><p>developed MAP4C (chiral version of MAP4, publ. in 2020)</p></li>
<li><p>MAP → “MinHashed Atom-Pair fingerprint up to four bonds”</p></li>
<li><p><strong>concept:</strong></p>
<ul>
<li>“MinHashes computed from character strings containing the SMILES of all pairs of circular substructures up to a diameter of four bonds and the shortest topological distance between their central atoms.”</li>
<li>MinHash = compression technique and used for similarity estimation <span class="citation" data-cites="probst2018probabilistic">(<a href="#ref-probst2018probabilistic" role="doc-biblioref">Probst and Reymond 2018</a>)</span>
<ul>
<li><a href="https://medium.com/@omkarsoak/from-min-hashing-to-locality-sensitive-hashing-the-complete-process-b88b298d71a1">easy explanation of minhashing from other field</a></li>
</ul></li>
<li>includes Cahn-Ingold-Prelog annotation (r,s)</li>
<li>“?” is used for undefined stereocenters and double bonds</li>
</ul></li>
<li><p><strong>claim:</strong></p>
<ul>
<li>can distinguish between stereoisomers of small drugs to large natural products and peptides</li>
</ul></li>
</ul>
</section>
<section id="introduction" class="level2">
<h2 class="anchored" data-anchor-id="introduction">Introduction</h2>
<ul>
<li><strong>What is a FP?</strong>
<ul>
<li>vectors encoding molecular structure</li>
</ul></li>
</ul>
<p><br>
</p>
<ul>
<li><strong>usage of fingerprints in general:</strong>
<ul>
<li>similarity &amp; substructure search, clustering</li>
<li>ligand-based virtual screening &amp; target prediction</li>
</ul></li>
</ul>
<p><br>
</p>
<ul>
<li><strong>Why are there almost no chiral FPs?</strong>
<ul>
<li>many small drug-like compounds are achiral (Paracetamol, Xylometazolin (Nasenspray), Amylmetakresol (Neo-Angin))</li>
<li><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="universal_chiral_fp_2024_images/chirality_in_dbs.png" class="img-fluid figure-img"></p>
<figcaption>“Correlation between chirality and heavy atom count (HAC) across ChEMBL, COCONUT, and ZINC datasets. The blue line depicts the percentage of chiral molecules relative to HAC. A steady increase in the percentage of chiral molecules is observed with increasing HAC. The yellow line represents the total count of molecules corresponding to each HAC.”</figcaption>
</figure>
</div></li>
</ul></li>
</ul>
<p><br>
</p>
<ul>
<li><strong>Principle of MAP4C?</strong>
<ul>
<li>combination of circular substructure encoding with data compression using MinHashing</li>
<li>encodes all possible pairs of circular substructures up to diameter of 4 bonds</li>
<li>pairs are written as two canonical smiles separated by shortest topological distance, counted in bonds between corresponding pair of central atoms</li>
<li>includes CIP-annotation</li>
<li>seems to be combination of circular FP and Atom Pair FP
<ul>
<li>Atom Pair = list all possible pairs and their distance</li>
</ul></li>
</ul></li>
</ul>
<p><br>
</p>
<ul>
<li><strong>Advantage over ECFP4 (Extended Connectivity) and AP (Atom Pair) FPs?</strong>
<ul>
<li>spans wider range of compound classes like small molecules, NPs, peptides and metabolites (claim)</li>
<li>is chiral</li>
</ul></li>
</ul>
</section>
<section id="methods" class="level2">
<h2 class="anchored" data-anchor-id="methods">Methods</h2>
<ul>
<li><strong>implementation in python (RDKit)</strong>
<ul>
<li>extraction of circular substructures at every non-hydrogen atom up to specified radius (r=2) as SMILES
<ul>
<li>isomeric information (“@”, “@@”) is removed manually</li>
<li>allene and conformational chirality not considered because not supported by SMILES (</li>
<li>Radius 0 skipped (no single atom information)</li>
</ul></li>
<li>if central atom is chiral, first atom symbol of max-radius SMILES is replaced by CIP-descriptor (e.g.&nbsp;“<span class="math inline">\(R\)</span>”)</li>
<li>at each radius “shingles” are generated for all possible pairs of extracted substructures
<ul>
<li>substructure 1 | topological distance | substructure 2</li>
<li>“shingles” → subsequences of a sequence</li>
</ul></li>
<li>Application of MinHash to obtain fixed size vector</li>
<li><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="universal_chiral_fp_2024_images/map4c_principle.png" class="img-fluid figure-img"></p>
<figcaption>“Chiral shingle generation concept exemplified on a selected atom pair of polymyxin B2. The generated shingle corresponds to the pair of circular substructures (blue) separated by the shortest topological distance (red) of their central atoms. Whenever the central atom of a substructure is chiral, the atom symbol in the substructure SMILES is replaced by the Cahn-Ingold-Prelog (CIP) descriptor (R, S, r, or s), or by a question mark (?) if the stereochemistry is not defined, bracketed by two “$” characters (yellow).”</figcaption>
</figure>
</div></li>
</ul></li>
<li><strong>Benchmark</strong>
<ul>
<li>MAP4C was compared with ECFP4 and 6, and Atom-Pair FP</li>
<li>Benchmark by Riniker and Landmark which was made chiral + 60 peptide sets
<ul>
<li><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="universal_chiral_fp_2024_images/distribution_mols_benchm.png" class="img-fluid figure-img"></p>
<figcaption>Figure S3. Distribution of molecular weight (MW) (yellow), number of stereocenters (magenta) and ratio of stereocenters to heavy atom count (blue) in the set uniformly sampled from the extended benchmark. The set contained a total of 10,122 compounds and was used to determine the relative impact of stereochemistry encoding on total similarity.</figcaption>
</figure>
</div></li>
<li>generated all possible stereoisomers, isomers and scrambled sequences with RDKit</li>
</ul></li>
<li>usage of 2048 bit vectors</li>
</ul></li>
</ul>
<p><br>
</p>
<ul>
<li><strong>TMAP:</strong>
<ul>
<li>visualization of biochemical similarity</li>
</ul></li>
</ul>
</section>
<section id="results" class="level2">
<h2 class="anchored" data-anchor-id="results">Results</h2>
<ul>
<li><strong>Encoding stereochemistry in MAP fingerprints</strong>
<ul>
<li>In simple words: map4 and map4c of the same molecule with and without stereochemistry are similar, as intended</li>
</ul></li>
</ul>
<p><br>
</p>
<ul>
<li><strong>Virtual screening benchmark</strong>
<ul>
<li>AUC, EF1, BEDROC, etc are all metrics for comparing virtual screening methods whose purpose is to rank active compounds towards e.g.&nbsp;an enzyme</li>
<li>comparison of performance of MAP, ECFP and AP FPs and their chiral counter parts → MAP4C performed best (fig 2c)
<ul>
<li><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="universal_chiral_fp_2024_images/vs_benchmarks.png" class="img-fluid figure-img"></p>
<figcaption>“Mean ranks of fingerprints across all virtual screening datasets for each metric. Small molecule sets (ChEMBL, DUD, MUV) and peptide sets are presented separately to highlight the differences in relative performance”</figcaption>
</figure>
</div></li>
<li>explanation: combination of high local precision from ECFP and reflection of global features from Atom-Pairs FP</li>
<li>slight bump compared to non-chiral MAPs due to chirality</li>
</ul></li>
</ul></li>
</ul>
<p><br>
</p>
<ul>
<li><p><strong>Finding all stereoisomers</strong></p>
<ul>
<li>Tab1 shows ability to assign a different fingerprint value for each stereoisomer on a series of stereochemically complex molecules comprizing carbohydrates, peptides and macrocyclic natural products (molecules shown in fig3)
<ul>
<li>MAPC performed well on sugars and peptides</li>
<li>performance decreased for macrocyclic NPs</li>
</ul></li>
</ul></li>
</ul>
<p><br>
</p>
<table class="caption-top table">
<colgroup>
<col style="width: 29%">
<col style="width: 13%">
<col style="width: 9%">
<col style="width: 8%">
<col style="width: 7%">
<col style="width: 7%">
<col style="width: 6%">
<col style="width: 8%">
<col style="width: 8%">
</colgroup>
<thead>
<tr class="header">
<th>Query</th>
<th>N / Sym.</th>
<th>Total</th>
<th>MAP6C</th>
<th>MAP4C</th>
<th>MAP2C</th>
<th>APC</th>
<th>ECFP6C</th>
<th>ECFP4C</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>α-D-glucopyranose (2)</td>
<td>5 /–</td>
<td>32</td>
<td>32</td>
<td>32</td>
<td>32</td>
<td>11</td>
<td>32</td>
<td>32</td>
</tr>
<tr class="even">
<td>Lactose (3)</td>
<td>10 / –</td>
<td>1,024</td>
<td>1,024</td>
<td>1,024</td>
<td>992</td>
<td>443</td>
<td>1,024</td>
<td>1,024</td>
</tr>
<tr class="odd">
<td>Trehalose (4)</td>
<td>10 / C2</td>
<td>528</td>
<td>528</td>
<td>528</td>
<td>516</td>
<td>336</td>
<td>528</td>
<td>512</td>
</tr>
<tr class="even">
<td>Validamycin A (5)</td>
<td>14 / –</td>
<td>16,384</td>
<td>16,384</td>
<td>16,384</td>
<td>16,384</td>
<td>7,657</td>
<td>16,384</td>
<td>16,384</td>
</tr>
<tr class="odd">
<td>Inositol (6)</td>
<td>6 / C6v</td>
<td>9</td>
<td>9</td>
<td>9</td>
<td>9</td>
<td>1</td>
<td>1</td>
<td>1</td>
</tr>
<tr class="even">
<td>ln65 (7)</td>
<td>11 / –</td>
<td>2,048</td>
<td>2,048</td>
<td>2,048</td>
<td>2,048</td>
<td>196</td>
<td>1,140</td>
<td>36</td>
</tr>
<tr class="odd">
<td>ln65 (scrambled)</td>
<td>11 / –</td>
<td>330</td>
<td>330</td>
<td>330</td>
<td>330</td>
<td>330</td>
<td>8</td>
<td>4</td>
</tr>
<tr class="even">
<td>ln65 (dia × scrambled)</td>
<td>11 / –</td>
<td>675,840</td>
<td>675,840</td>
<td>675,840</td>
<td>675,840</td>
<td>90,217</td>
<td>38,500</td>
<td>144</td>
</tr>
<tr class="odd">
<td>R9 (8)</td>
<td>9 / –</td>
<td>512</td>
<td>512</td>
<td>512</td>
<td>512</td>
<td>146</td>
<td>88</td>
<td>12</td>
</tr>
<tr class="even">
<td>Polymyxin B2 (1)</td>
<td>12 / –</td>
<td>4,096</td>
<td>4,096</td>
<td>4,096</td>
<td>4,096</td>
<td>2,500</td>
<td>4,096</td>
<td>1,536</td>
</tr>
<tr class="odd">
<td>PMB2 (scrambled)</td>
<td>9 / –</td>
<td>1,512</td>
<td>1,512</td>
<td>1,512</td>
<td>1,512</td>
<td>1,512</td>
<td>861</td>
<td>75</td>
</tr>
<tr class="even">
<td>PMB2 (dia × scrambled)</td>
<td>9 / –</td>
<td>774,144</td>
<td>774,144</td>
<td>774,144</td>
<td>774,144</td>
<td>287,631</td>
<td>602,003</td>
<td>9,312</td>
</tr>
<tr class="odd">
<td>PMB2 (R, S or undefined)</td>
<td>12 / –</td>
<td>531,441</td>
<td>531,441</td>
<td>531,441</td>
<td>531,441</td>
<td>277,901</td>
<td>531,441</td>
<td>137,781</td>
</tr>
<tr class="even">
<td>Quinaldopeptin (9)</td>
<td>8 / C2</td>
<td>136</td>
<td>136 g)</td>
<td>136</td>
<td>134</td>
<td>64</td>
<td>132</td>
<td>90</td>
</tr>
<tr class="odd">
<td>Onchidin (10)</td>
<td>12 / C2</td>
<td>2,080</td>
<td>2,080</td>
<td>2,080</td>
<td>2,064</td>
<td>469</td>
<td>1,760</td>
<td>810</td>
</tr>
<tr class="even">
<td><strong>Gramicidin S (11)</strong></td>
<td>10 / C2</td>
<td>528</td>
<td>528</td>
<td>504</td>
<td>334</td>
<td>25</td>
<td>448</td>
<td>243</td>
</tr>
<tr class="odd">
<td><strong>Valinomycin (12)</strong></td>
<td>12 / C3</td>
<td>1,376</td>
<td>1,250</td>
<td>714</td>
<td>416</td>
<td>112</td>
<td>616</td>
<td>27</td>
</tr>
<tr class="even">
<td><strong>Nonactin (13)</strong></td>
<td>16 / C4</td>
<td>16,456</td>
<td>16,425</td>
<td>16,176</td>
<td>10,045</td>
<td>13,189</td>
<td>6,474</td>
<td>675</td>
</tr>
<tr class="odd">
<td><strong>NP213 (14)</strong></td>
<td>7 / C7</td>
<td>20</td>
<td>7</td>
<td>13</td>
<td>17</td>
<td>13</td>
<td>5</td>
<td>3</td>
</tr>
</tbody>
</table>
<p><br>
</p>
<ul>
<li><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="universal_chiral_fp_2024_images/molecules.png" class="img-fluid figure-img" width="600"></p>
<figcaption>“Structures of natural products and peptides selected for the stereoisomer distinction task”</figcaption>
</figure>
</div></li>
</ul>
<p><br>
</p>
<ul>
<li><strong>Ranking stereoisomers versus isomers</strong>
<ul>
<li>Fig4 shows that MAP4C works well in differentiating stereo and structural isomers
<ul>
<li>this is indicated by the much higher jaccard distance (similarity measure) for the MAP FPs, which shows that though there are only small changes in chirality and structure, the FP is still sensitive to their difference</li>
<li><div class="quarto-figure quarto-figure-center">
<figure class="figure">
<p><img src="universal_chiral_fp_2024_images/jaccard_dist.png" class="img-fluid figure-img"></p>
<figcaption>“structural isomers of 1,4-diaminocyclohexane (203) and 4-aminopiperidine (48) and their diastereomers. The skewed distribution of Jaccard distance of 15 with MAP6C is caused by two outliers exhibiting a distance of 0 which cannot be represented on the log scale and is likely due to a bit-clash issue.”</figcaption>
</figure>
</div></li>
</ul></li>
</ul></li>
</ul>
</section>
<section id="conclusion" class="level2">
<h2 class="anchored" data-anchor-id="conclusion">Conclusion</h2>
<ul>
<li>chiral version of MAP performs as good as achiral versions</li>
<li>perform better in distinguishing stereoisomers than chiral ECFP and AP</li>
</ul>
</section>
<section id="what-i-likeddidnt-like-about-the-paper" class="level2">
<h2 class="anchored" data-anchor-id="what-i-likeddidnt-like-about-the-paper">What I liked/didn’t like about the paper</h2>
<ul>
<li>didn’t like:
<ul>
<li>hard to read</li>
<li>TMAP not explained (supposed to mean Tree MAP)</li>
<li>“scrambled sequences” not explained</li>
<li>repetition of how FP works in methods and beginning of results</li>
<li>in supporting info S4 figure “c” is missing</li>
<li>typical paper from the “our tool is the best”-field, would have been nice if they included some critical statistics for e.g.&nbsp;bit-collisions</li>
<li>no reference made to the field of machine learning</li>
</ul></li>
<li>like:
<ul>
<li>they made quite an effort to test their new FP</li>
</ul></li>
</ul>
</section>
<section id="references" class="level2">
<h2 class="anchored" data-anchor-id="references">References</h2>


<div id="refs" class="references csl-bib-body hanging-indent" data-entry-spacing="0" role="list">
<div id="ref-capecchi2020one" class="csl-entry" role="listitem">
Capecchi, Alice, Daniel Probst, and Jean-Louis Reymond. 2020. <span>“One Molecular Fingerprint to Rule Them All: Drugs, Biomolecules, and the Metabolome.”</span> <em>Journal of Cheminformatics</em> 12: 1–15.
</div>
<div id="ref-carhart1985atom" class="csl-entry" role="listitem">
Carhart, Raymond E, Dennis H Smith, and RENGACHARI Venkataraghavan. 1985. <span>“Atom Pairs as Molecular Features in Structure-Activity Studies: Definition and Applications.”</span> <em>Journal of Chemical Information and Computer Sciences</em> 25 (2): 64–73.
</div>
<div id="ref-https://doi.org/10.48550/arxiv.2410.11527" class="csl-entry" role="listitem">
Guo, Jeff, and Philippe Schwaller. 2024. <span>“It Takes Two to Tango: Directly Optimizing for Constrained Synthesizability in Generative Molecular Design.”</span> arXiv. <a href="https://doi.org/10.48550/ARXIV.2410.11527">https://doi.org/10.48550/ARXIV.2410.11527</a>.
</div>
<div id="ref-landrum_lwreg_2024" class="csl-entry" role="listitem">
Landrum, Gregory A., Jessica Braun, Paul Katzberger, Marc T. Lehner, and Sereina Riniker. 2024. <span>“Lwreg: <span>A</span> <span>Lightweight</span> <span>System</span> for <span>Chemical</span> <span>Registration</span> and <span>Data</span> <span>Storage</span>.”</span> <em>Journal of Chemical Information and Modeling</em> 64 (16): 6247–52. <a href="https://doi.org/10.1021/acs.jcim.4c01133">https://doi.org/10.1021/acs.jcim.4c01133</a>.
</div>
<div id="ref-orsi2024one" class="csl-entry" role="listitem">
Orsi, Markus, and Jean-Louis Reymond. 2024. <span>“One Chiral Fingerprint to Find Them All.”</span> <em>Journal of Cheminformatics</em> 16 (1): 53.
</div>
<div id="ref-probst2018probabilistic" class="csl-entry" role="listitem">
Probst, Daniel, and Jean-Louis Reymond. 2018. <span>“A Probabilistic Molecular Fingerprint for Big Data Settings.”</span> <em>Journal of Cheminformatics</em> 10: 1–12.
</div>
<div id="ref-rogers2010extended" class="csl-entry" role="listitem">
Rogers, David, and Mathew Hahn. 2010. <span>“Extended-Connectivity Fingerprints.”</span> <em>Journal of Chemical Information and Modeling</em> 50 (5): 742–54.
</div>
</div>
</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
<nav class="page-navigation">
  <div class="nav-page nav-page-previous">
      <a href="../papers/open-source-cheminformatics.html" class="pagination-link" aria-label="Open-Source Software Development in Cheminformatics: A Qualitative Analysis of Rationales">
        <i class="bi bi-arrow-left-short"></i> <span class="nav-page-text"><span class="chapter-title">Open-Source Software Development in Cheminformatics: A Qualitative Analysis of Rationales</span></span>
      </a>          
  </div>
  <div class="nav-page nav-page-next">
      <a href="../papers/lwreg_2024.html" class="pagination-link" aria-label="lwreg: A Lightweight System for Chemical Registration and Data Storage [@landrum_lwreg_2024]">
        <span class="nav-page-text"><span class="chapter-title">lwreg: A Lightweight System for Chemical Registration and Data Storage <span class="citation" data-cites="landrum_lwreg_2024">(</span></span></span></a><a href="#ref-landrum_lwreg_2024" role="doc-biblioref">Landrum et al. 2024</a>) <i class="bi bi-arrow-right-short"></i>
      
  </div>
</nav>
</div> <!-- /content -->




</body></html>